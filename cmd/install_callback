#!/bin/bash
# cmd/install_callback - qBittorrent安装后置脚本

set -e

APP_NAME="qbittorrent"
BIN_DIR="${TRIM_APPDEST}/bin"
CONFIG_DIR="${TRIM_PKGVAR}/config"
DATA_DIR="${TRIM_PKGVAR}"
ERROR_LOG="${TRIM_TEMP_LOGFILE:-/tmp/${APP_NAME}_error.log}"

echo "Running ${APP_NAME} install_callback..."

# 设置可执行权限
if ! chmod +x "$BIN_DIR/qbittorrent-nox" 2>/dev/null; then
    echo "Error: Failed to set executable permission on qbittorrent-nox" > "$ERROR_LOG"
    exit 1
fi

echo "=================================="
echo "qBittorrent installation complete"
echo "=================================="
echo ""
echo "Default credentials:"
echo "  WebUI: http://$(hostname -I | awk '{print $1}'):8080"
echo "  Username: admin"
echo "  Password: adminadmin"
echo ""
echo "IMPORTANT: Please change the default password after first login!"
echo ""
echo "Data location: $DATA_DIR"
echo "Config location: $CONFIG_DIR"
echo ""

echo "qBittorrent installed successfully"
exit 0
